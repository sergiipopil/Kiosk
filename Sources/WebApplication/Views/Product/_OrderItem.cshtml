@model IList<WebApplication.Classes.CartProduct>
@{
    Layout = null;
}
<html>
<body>
    @*<div class="mainBlockTitle" style="background: #EEEFFF;">
            <div onclick="ReturnToCart()" style="color: white; padding: 0px 10px; font-weight: normal; border-radius: 10px; font-size: 23px; width:100px; text-transform: capitalize; background: #ff5a00;">
                <span>Назад</span>
            </div>
        </div>*@
    <div style="text-align:center;color:white;">
        <h3>У Вас в корзине</h3>
    </div>
    @foreach (var item in Model)
    {
        <div class="warningText">Внимание! В цену на товар уже включены: доставка, страховка и таможенная пошлина</div>
        <div class="divProductListCard">
            <div class="row">
                <div class="col-lg-3">
                    <div id="imageBlock" class="detailBlock" style="text-align:center;background:white;width:-webkit-fill-available;">
                        <img id="mainImageProduct" src="@item.Product.Photos[0].Url" style="max-width:100%;max-height:160px;" />
                        @if (item.Product.Photos.Count() > 1)
                        {
                            <a href=@item.Product.Photos[0].Url data-fancybox="@String.Format("galleryProduct{0}", item.Product.Key)" class="noneDecoration" style="color:#ff5a00;font-weight:500;">
                                <div class="enlargePhoto"> ФОТО+ (@item.Product.Photos.Count())</div>
                            </a>
                            @foreach (var smallImage in @item.Product.Photos)
                            {
                                if (smallImage.Url != item.Product.Photos[0].Url)
                                {
                                    <a href="@smallImage.Url" data-fancybox="@String.Format("galleryProduct{0}", item.Product.Key)" class="noneDecoration" style="visibility:hidden;display:none;">
                                        <img src="@smallImage.Url" class="smallPhotoes">
                                    </a>
                                }
                            }
                        }
                    </div>
                </div>

                <div class="col-lg-6" style="position:relative;">
                    <div style="vertical-align: top;position:absolute;display:block !important;" class="hide">
                        <span class="productTitle" style="color: #222 !important;text-decoration:none !important;">@item.Product.Name.Last().Value<span class="productNumberId">( @item.Product.SourceId )</span></span>
                    </div>
                    @*<div class="openProductDEtailsBtn" onclick="openDetails('@item.Product.SourceId', '@item.Product.Price')">Подробнее</div>*@
                </div>

                <div class="col-lg-3">
                    <div class="inline-blockPrice" style="border-left: 1px solid #c3c4c5;padding-left:20px;">
                        <div style="color: #ff5a00;font-weight:bold;">
                            <span class="divProductPrice" style="font-size:32px;">@item.Product.FinalPrice</span>
                            <span class="divProductCurrency" style="font-size:18px;">@item.Product.PriceCurrencyCode</span>
                            <span id="priceDeliveryComment" style="color:#ff5a00;font-size:16px;font-weight:700;display:block;">всё включено в цену</span>
                            <span id="priceDeliveryComment" style="color:#6c7096;font-size:14px;display:block;font-weight:normal;">Проверенный продавец</span>
                            <p id="priceComment" style="color:#6c7096;font-size:14px;font-weight:normal;margin-bottom:0px;">быстрая доставка</p>
                            <p id="priceComment" style="color:#6c7096;font-size:14px;font-weight:normal;">Гарантия 21 день</p>
                        </div>
                        <div style="color: #ff5a00; text-align: center;">Безопасная покупка</div>
                        @*<div style="padding:4px 0px;">
                                <span>
                                    <input type="number" id="@item.Product.SourceId" value="@item.Quantity" class="cartQuantity" />
                                </span>
                                <span>
                                    <a class="quantityBtn" onclick="refreshCartItem('@item.Product.SourceId')">Оновити к-ть</a>
                                </span>
                            </div>*@
                        @*<div onclick="deleteProduct('@item.Product.SourceId')">
                                <button class="btnDeleteCartItem">
                                    <img src="~/images/Cart/Delete.png" />
                                    <span>Видалити</span>
                                </button>
                            </div>*@
                    </div>
                </div>
            </div>
        </div>
    }

    <div style="text-align:center;color:white;">
        <label id="mainCartTotalPrice" style="font-size:22px;font-weight:normal;">
            Общая сумма:
            @if (@ViewData["CartWidgetPrice"] == null)
            {<span>0</span> }
            else
            {@ViewData["CartWidgetPrice"]}
        </label><label style="font-size:18px;"> UAH</label>
    </div>
    <table class="garantedCardsTable">
        <tr>
            <td style="background:white;">
                <button id='open' class="simpleBtn" data-toggle="modal" data-target="#showmodal_PopUp" data-menuitem="GarantedPayItem">
                    <div class="menuItemPic" style="max-width: 100%; width: 100%; display: block;text-align:center;"><img src="~/images/OrderAdvert/GarantedPay.png" style="max-height:100px;" /></div><div class="inline-block" style="color:#080c31;text-align:center;padding-left:10px;"><div>Безопасная покупка</div></div>
                </button>
            </td>
            <td style="background:white;">
                <button id='open' class="simpleBtn" data-toggle="modal" data-target="#showmodal_PopUp" data-menuitem="dostavka100Item">
                    <div class="menuItemPic" style="max-width: 100%; width: 100%; display: block;text-align:center;"><img src="~/images/OrderAdvert/dostavka100.png" style="max-height:100px;" /></div><div class="inline-block" style="color:#080c31;text-align:center;padding-left:10px;">Бесплатная доставка до 30кг</div>
                </button>
            </td>
            <td style="background:white;">
                <button id='open' class="simpleBtn" data-toggle="modal" data-target="#showmodal_PopUp" data-menuitem="User100Item">
                    <div class="menuItemPic" style="max-width: 100%; width: 100%; display: block;text-align:center;"><img src="~/images/OrderAdvert/User100.png" style="max-height:100px;" /></div><div class="inline-block" style="color:#080c31;text-align:center;padding-left:10px;"><div>Защита потребителя</div></div>
                </button>
            </td>
        </tr>
    </table>
    <script>
        function refreshCartItem(idControl) {
            $.ajax({
                type: "GET",
                url: '@Url.Action("EditCartItemQuantity", "Product")' + "?cartItemId=" + idControl + "&quantity=" + $("#" + idControl).val(),
                success: function (data) {
                    $('#divCartViewControl').empty();
                    $('#divCartViewControl').html(data);
                    $("#cartWidgetPrice").text($("#mainCartTotalPrice").text());
                }
            });
    }
    function deleteProduct(idControl) {

        $.ajax({
                type: "GET",
                url: '@Url.Action("DeleteProductFromCart", "Product")' + "?cartItemId=" + idControl,
            success: function (data) {
                $('#divCartViewControl').empty();
                $('#divCartViewControl').html(data);

                $("#cartWidgetPrice").text($("#mainCartTotalPrice").text());
                //if (data.is("#emptyCart")) {
                //    $("#cartWidgetEmpty").show();
                //    $("#cartWidgetValue").hide();
                //}
                }
            });
    }
    </script>
</body>
</html>
